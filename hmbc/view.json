{
    "grid": {
        "layers": {
            "Default layer": {
                "name": "Default layer"
            }
        },
        "xWidth": 10,
        "yHeight": 10
    },
    "version": "2.4.1",
    "modules": [
        {
            "url": "modules/types/science/chemistry/jsme/",
            "configuration": {
                "sections": {},
                "groups": {
                    "group": [
                        {
                            "prefs": [
                                [
                                    "oldlook"
                                ]
                            ],
                            "labelsize": [
                                14
                            ],
                            "bondwidth": [
                                1
                            ]
                        }
                    ]
                }
            },
            "layers": {
                "Default layer": {
                    "position": {
                        "left": 0,
                        "top": 0
                    },
                    "size": {
                        "width": 40.01818182468414,
                        "height": 42.01818182468414
                    },
                    "zIndex": 0,
                    "display": true,
                    "title": "Molecule",
                    "bgcolor": [
                        [
                            255,
                            255,
                            255,
                            0
                        ]
                    ],
                    "wrapper": true,
                    "created": true,
                    "name": "Default layer",
                    "bgColor": [
                        255,
                        255,
                        255,
                        0
                    ]
                }
            },
            "id": 1,
            "vars_in": [
                {
                    "rel": "mol",
                    "name": "molfile-ext"
                }
            ],
            "actions_in": {},
            "title": "Molecule",
            "vars_out": [
                {
                    "event": "onStructureChange",
                    "rel": "mol",
                    "jpath": [],
                    "name": "molfile"
                }
            ],
            "actions_out": {},
            "zindex": 1
        },
        {
            "url": "modules/types/science/spectra/spectra_displayer/",
            "configuration": {
                "sections": {},
                "groups": {
                    "group": [
                        {
                            "graphurl": [
                                ""
                            ],
                            "flip": [
                                [
                                    "flipX",
                                    "flipY"
                                ]
                            ],
                            "displayAxis": [
                                [
                                    "x",
                                    "y"
                                ]
                            ],
                            "grids": [
                                []
                            ],
                            "xLabel": [
                                ""
                            ],
                            "yTopSpacing": [
                                0
                            ],
                            "yBottomSpacing": [
                                0
                            ],
                            "xLeftSpacing": [
                                0
                            ],
                            "xRightSpacing": [
                                0
                            ],
                            "yLabel": [
                                ""
                            ],
                            "minX": [
                                "0.001"
                            ],
                            "maxX": [
                                "10"
                            ],
                            "minY": [
                                "0.001"
                            ],
                            "maxY": [
                                "200"
                            ],
                            "zoom": [
                                "xy"
                            ],
                            "shiftxtozero": [
                                []
                            ],
                            "xastime": [
                                []
                            ],
                            "wheelAction": [
                                "none"
                            ],
                            "fullOut": [
                                "both"
                            ]
                        }
                    ],
                    "plotinfos": [
                        [
                            {
                                "variable": "hmbc",
                                "plotcolor": [
                                    1,
                                    1,
                                    255,
                                    0.52
                                ],
                                "strokewidth": "1",
                                "plotcontinuous": [
                                    "continuous"
                                ],
                                "peakpicking": [],
                                "markers": [],
                                "normalize": "none",
                                "optimizeSlots": []
                            },
                            {
                                "variable": "hmbcExp",
                                "plotcolor": [
                                    255,
                                    92,
                                    0,
                                    0.78
                                ],
                                "strokewidth": "1",
                                "plotcontinuous": [
                                    "continuous"
                                ],
                                "peakpicking": [],
                                "markers": [],
                                "normalize": "none",
                                "optimizeSlots": []
                            }
                        ]
                    ]
                }
            },
            "layers": {
                "Default layer": {
                    "position": {
                        "left": 41,
                        "top": 0
                    },
                    "size": {
                        "width": 83.01818182468415,
                        "height": 72.01818182468415
                    },
                    "zIndex": 0,
                    "display": true,
                    "title": "HMBC (2J and 3J: yellow, 4J: blue) + HSQC (1J: red)",
                    "bgcolor": [
                        [
                            255,
                            255,
                            255,
                            0
                        ]
                    ],
                    "wrapper": true,
                    "created": true,
                    "name": "Default layer",
                    "bgColor": [
                        255,
                        255,
                        255,
                        0
                    ]
                }
            },
            "id": 2,
            "vars_in": [
                {
                    "rel": "jcamp",
                    "name": "hmbc"
                },
                {
                    "rel": "annotations",
                    "name": "hmbcPP"
                },
                {
                    "rel": "jcamp",
                    "name": "hmbcExp"
                },
                {
                    "rel": "jcamp",
                    "name": "hsqc"
                },
                {
                    "rel": "annotations",
                    "name": "hsqcPP"
                }
            ],
            "actions_in": [
                {}
            ],
            "title": "HMBC (2J and 3J: yellow, 4J: blue) + HSQC (1J: red)",
            "vars_out": [
                {
                    "jpath": []
                }
            ],
            "actions_out": [
                {
                    "jpath": []
                }
            ],
            "zindex": 3
        },
        {
            "url": "modules/types/server_interaction/webservice_search/",
            "configuration": {
                "sections": {
                    "postvariables": [
                        {
                            "sections": {},
                            "groups": {
                                "postvariables": [
                                    [
                                        {
                                            "name": "molfile",
                                            "destination": "data",
                                            "variable": "molfile",
                                            "filter": "value"
                                        },
                                        {
                                            "name": "molfile",
                                            "destination": "url",
                                            "variable": "molfile",
                                            "filter": "none"
                                        }
                                    ]
                                ]
                            }
                        }
                    ]
                },
                "groups": {
                    "group": [
                        {
                            "url": [
                                "http://script.epfl.ch/script/Service/20140826/3vnB5DioPx"
                            ],
                            "method": [
                                "POST"
                            ],
                            "dataType": [
                                "form"
                            ],
                            "button": [
                                [
                                    "button"
                                ]
                            ],
                            "buttonlabel": [
                                "Simulate spectra"
                            ],
                            "buttonlabel_exec": [
                                "Simulating..."
                            ],
                            "onloadsearch": [
                                []
                            ],
                            "resultfilter": [
                                null
                            ]
                        }
                    ],
                    "headers": [
                        [
                            {}
                        ]
                    ],
                    "searchparams": [
                        [
                            {
                                "destination": "url",
                                "fieldtype": "text"
                            }
                        ]
                    ]
                }
            },
            "layers": {
                "Default layer": {
                    "position": {
                        "left": 27,
                        "top": 35
                    },
                    "size": {
                        "width": 16,
                        "height": 9
                    },
                    "zIndex": 0,
                    "display": true,
                    "title": "Click me",
                    "bgcolor": [
                        [
                            255,
                            255,
                            255,
                            0
                        ]
                    ],
                    "wrapper": false,
                    "created": true,
                    "name": "Default layer",
                    "bgColor": [
                        255,
                        255,
                        255,
                        0
                    ]
                }
            },
            "id": 3,
            "vars_in": [
                {
                    "rel": "vartrigger",
                    "name": "molfile-ext"
                }
            ],
            "actions_in": [
                {
                    "rel": "doSearch",
                    "name": "donmrpredict"
                }
            ],
            "title": "Click me",
            "vars_out": [
                {
                    "event": "onSearchReturn",
                    "rel": "results",
                    "jpath": [
                        "resultLog"
                    ],
                    "name": "log"
                },
                {
                    "event": "onSearchReturn",
                    "rel": "results",
                    "jpath": [
                        "result",
                        "spectrumHMBC",
                        "jcamp2D"
                    ],
                    "name": "hmbc"
                },
                {
                    "event": "onSearchReturn",
                    "rel": "results",
                    "jpath": [
                        "result",
                        "spectrumHMBC",
                        "annotations2D"
                    ],
                    "name": "hmbcPP"
                },
                {
                    "event": "onSearchReturn",
                    "rel": "results",
                    "jpath": [
                        "result",
                        "spectrumHSQC",
                        "jcamp2D"
                    ],
                    "name": "hsqc"
                },
                {
                    "event": "onSearchReturn",
                    "rel": "results",
                    "jpath": [
                        "result",
                        "spectrumHSQC",
                        "annotations2D"
                    ],
                    "name": "hsqcPP"
                }
            ],
            "actions_out": [
                {
                    "jpath": []
                }
            ],
            "zindex": 3
        },
        {
            "url": "modules/types/display/single_value/",
            "configuration": {
                "sections": {},
                "groups": {
                    "group": [
                        {
                            "defaultvalue": [
                                null
                            ],
                            "fontcolor": [
                                [
                                    0,
                                    0,
                                    0,
                                    1
                                ]
                            ],
                            "font": [
                                null
                            ],
                            "fontsize": [
                                null
                            ],
                            "align": [
                                null
                            ],
                            "valign": [
                                null
                            ],
                            "sprintf": [
                                null
                            ],
                            "sprintfOrder": [
                                null
                            ],
                            "preformatted": [
                                []
                            ]
                        }
                    ]
                }
            },
            "layers": {
                "Default layer": {
                    "position": {
                        "left": 1,
                        "top": 43
                    },
                    "size": {
                        "width": 39.01818182468414,
                        "height": 6.018181824684143
                    },
                    "zIndex": 0,
                    "display": true,
                    "title": "Log",
                    "bgcolor": [
                        [
                            255,
                            255,
                            255,
                            0
                        ]
                    ],
                    "wrapper": true,
                    "created": true,
                    "name": "Default layer"
                }
            },
            "id": 4,
            "vars_in": [
                {
                    "rel": "value",
                    "name": "log"
                }
            ],
            "actions_in": {},
            "title": "Log",
            "vars_out": {},
            "actions_out": {},
            "zindex": 3
        },
        {
            "url": "modules/types/client_interaction/dragdrop/",
            "configuration": {
                "sections": {},
                "groups": {
                    "group": [
                        {
                            "label": [
                                "Drop your file here"
                            ],
                            "dragoverlabel": [
                                null
                            ],
                            "hoverlabel": [
                                null
                            ]
                        }
                    ],
                    "vars": [
                        [
                            {
                                "extension": "*",
                                "filetype": "text",
                                "type": "jcamp",
                                "variable": "file"
                            }
                        ]
                    ],
                    "string": [
                        [
                            {
                                "type": "string",
                                "variable": "str"
                            }
                        ]
                    ]
                }
            },
            "layers": {
                "Default layer": {
                    "position": {
                        "left": 1,
                        "top": 49.999996185302734
                    },
                    "size": {
                        "width": 39.01818182468414,
                        "height": 22.01818182468414
                    },
                    "zIndex": 0,
                    "display": true,
                    "title": "HMBC/HSQC",
                    "bgcolor": [
                        [
                            255,
                            255,
                            255,
                            0
                        ]
                    ],
                    "wrapper": true,
                    "created": true,
                    "name": "Default layer"
                }
            },
            "id": 5,
            "vars_in": [],
            "title": "HMBC/HSQC",
            "vars_out": [
                {
                    "event": "onRead",
                    "rel": "data",
                    "jpath": [
                        "file",
                        "content"
                    ],
                    "name": "hmbcExp"
                },
                {
                    "event": "onRead",
                    "rel": "data",
                    "jpath": [
                        "str",
                        "content"
                    ],
                    "name": "hmbcExp"
                }
            ],
            "actions_in": {},
            "actions_out": {},
            "zindex": 3
        }
    ],
    "variables": [
        {
            "varname": "resultLog",
            "jpath": [
                "resultLog"
            ]
        },
        {
            "varname": "result",
            "jpath": [
                "result"
            ]
        },
        {
            "varname": "jme",
            "jpath": [
                "result",
                "jme",
                "jmeNumbers"
            ]
        },
        {
            "varname": "jcamp1H",
            "jpath": [
                "result",
                "spectrum1H",
                "jcamp"
            ]
        },
        {
            "varname": "annotations1H",
            "jpath": [
                "result",
                "spectrum1H",
                "annotations"
            ]
        },
        {
            "varname": "ms",
            "jpath": [
                "result",
                "jcampMS"
            ]
        },
        {
            "varname": "jcamp13C",
            "jpath": [
                "result",
                "spectrum13C",
                "jcamp"
            ]
        },
        {
            "varname": "annotations13C",
            "jpath": [
                "result",
                "spectrum13C",
                "annotations"
            ]
        },
        {
            "varname": "cosy",
            "jpath": [
                "result",
                "spectrumCOSY",
                "jcamp2D"
            ]
        },
        {
            "varname": "cosyPP",
            "jpath": [
                "result",
                "spectrumCOSY",
                "annotations2D"
            ]
        },
        {
            "varname": "hmbc",
            "jpath": [
                "result",
                "spectrumHMBC",
                "jcamp2D"
            ]
        },
        {
            "varname": "hmbcPP",
            "jpath": [
                "result",
                "spectrumHMBC",
                "annotations2D"
            ]
        },
        {
            "varname": "log",
            "jpath": [
                "resultLog"
            ]
        },
        {
            "varname": "predictions",
            "jpath": [
                "predictions"
            ]
        },
        {
            "varname": "chemcalc",
            "jpath": [
                "chemcalc"
            ]
        }
    ],
    "pouchvariables": [
        {}
    ],
    "configuration": {
        "title": "Simulate HMBC/HSQC"
    },
    "actionscripts": [
        {
            "sections": {},
            "groups": {
                "action": [
                    {
                        "name": [
                            null
                        ],
                        "script": [
                            null
                        ]
                    }
                ]
            }
        }
    ],
    "crons": [
        {}
    ],
    "couch_replication": [
        {
            "sections": {},
            "groups": {
                "couch": [
                    [
                        {
                            "direction": "both",
                            "continuous": []
                        }
                    ]
                ]
            }
        }
    ],
    "init_script": [
        {
            "sections": {},
            "groups": {
                "general": [
                    {
                        "script": [
                            "require(['src/util/pouchtovar'], function(pouchtovar) {\n    Promise.all([pouchtovar.pouchToVar('external_infos', 'molfile'), pouchtovar.pouchToVar('external_infos', 'smiles')]).then(function(value) {\n        var molfile = value[0];\n        var smiles = value[1];\n        \n\n        if(!molfile._rev && !smiles._rev) {\n            console.log('not available');\n            return;\n        }\n        var useMolfile = (molfile._rev && !smiles._rev) || (molfile._rev && smiles._rev && molfile.timestamp > smiles.timestamp);\n        \n        if(useMolfile) {\n            console.log('use molfile', molfile);\n            $.ajax({\n                url: 'http://script.epfl.ch/script/Service/20140826/IXnW4ymIPf',\n                type: 'POST',\n                data: { molfile: molfile.get() },\n                dataType: 'json'\n            }).done(function(val) {\n                console.log('checked molfile:', val);\n                var checkedMolfile = DataObject.check({type:'mol2d', value: val.molfile});\n                API.createData('molfile', checkedMolfile);\n                API.createData('molfile-ext', checkedMolfile);\n            });\n            \n\n            \n            \n        }\n        else {\n            console.log('use smiles');\n            $.ajax({\n                url: 'http://www.nmrdb.org/service/smiles2molfile',\n                type: 'POST',\n                data: {smiles: smiles.get()},\n                dataType: 'json'\n            }).done(function(val){\n                var molfile = DataObject.check({type:'mol2d', value: val.molfile});\n                API.createData('molfile', molfile);\n                API.createData('molfile-ext', molfile);\n            })\n        }\n    });\n    \n    \n    console.log(pouchtovar);\n});"
                        ]
                    }
                ]
            }
        }
    ],
    "actionfiles": [
        {
            "sections": {},
            "groups": {
                "action": [
                    [
                        {}
                    ]
                ]
            }
        }
    ]
}